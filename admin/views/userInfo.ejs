<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BoltCDL | Student Profile</title>

    <link rel="shortcut icon" href="../../static/images/thumb.png">
    <link rel="stylesheet" href="/admin/views/user-info_styles.css">

</head>
<body>

    <!-- sprite -->
    <svg class="-hidden-sprite">
        <symbol id="delete" viewBox="0 0 32 32">
            <line class="cls-1" x1="7" x2="25" y1="7" y2="25"/>
            <line class="cls-1" x1="7" x2="25" y1="25" y2="7"/>
        </symbol>
    </svg>
    
    <svg class="-hidden-sprite">
        <symbol id="redo" viewBox="0 0 40.5 40.5">
            <path d="M40.5,20.25c0,9.374-7.625,17-17,17c-1.656,0-3-1.343-3-3s1.344-3,3-3c6.064,0,11-4.936,11-11c0-6.065-4.936-11-11-11 c-5.756,0-10.486,4.447-10.953,10.086l1.832-1.832c1.171-1.172,3.071-1.172,4.242,0c1.172,1.171,1.172,3.071,0,4.242l-6.75,6.75 c-0.563,0.562-1.326,0.879-2.121,0.879c-0.796,0-1.559-0.316-2.121-0.879l-6.75-6.75c-1.172-1.172-1.172-3.071,0-4.242 c1.172-1.172,3.071-1.172,4.243,0l1.444,1.444c0.669-8.766,8-15.698,16.934-15.698C32.875,3.25,40.5,10.876,40.5,20.25z"/>
        </symbol>
    </svg>


    <header>
        <!-- HOME element -->
        <a href="/admin/profile" class="header-left-item">
            <img src="/static/images/logo-small.png" alt="BOLT logo small" class="bolt-home">
            <span class="item-home">Home</span>
        </a>      <!-- header-left-item -->
        <!-- CENTER element -->
        <nav class="header-center-item">
            <div class="nav-left-side">
                <a href="/admin/user-area" class="header-nav-item" id="user-area" title="Users Area">
                    <svg width="25" height="18" viewBox="0 0 25 18">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M12.5 4.10959C10.7741 4.10959 9.375 5.33621 9.375 6.84932C9.375 8.36243 10.7741 9.58904 12.5 9.58904C14.2259 9.58904 15.625 8.36243 15.625 6.84932C15.625 5.33621 14.2259 4.10959 12.5 4.10959ZM7.8125 6.84932C7.8125 4.57965 9.91117 2.73973 12.5 2.73973C15.0888 2.73973 17.1875 4.57965 17.1875 6.84932C17.1875 9.11898 15.0888 10.9589 12.5 10.9589C9.91117 10.9589 7.8125 9.11898 7.8125 6.84932Z" />
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M8.08058 13.2487C9.25269 12.2211 10.8424 11.6438 12.5 11.6438C14.1576 11.6438 15.7473 12.2211 16.9194 13.2487C18.0915 14.2763 18.75 15.67 18.75 17.1233C18.75 17.5016 18.4002 17.8082 17.9688 17.8082H7.03125C6.82405 17.8082 6.62534 17.7361 6.47882 17.6076C6.33231 17.4792 6.25 17.3049 6.25 17.1233C6.25 15.67 6.90848 14.2763 8.08058 13.2487ZM12.5 13.0137C11.2568 13.0137 10.0645 13.4467 9.18544 14.2174C8.49271 14.8247 8.03919 15.6025 7.87804 16.4384H17.122C16.9608 15.6025 16.5073 14.8247 15.8146 14.2174C14.9355 13.4467 13.7432 13.0137 12.5 13.0137Z" />
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M16.8443 0.354968C17.5743 0.0701711 18.3752 -0.0463026 19.171 0.0166068C19.9668 0.0795162 20.731 0.31972 21.3911 0.71441C22.0512 1.1091 22.5853 1.64517 22.9426 2.27173C23.3 2.89828 23.4687 3.59451 23.4328 4.29431C23.3968 4.99411 23.1575 5.67424 22.7374 6.27013C22.3174 6.86602 21.7305 7.35787 21.0326 7.69899C20.3348 8.04012 19.549 8.21918 18.75 8.21918C18.3185 8.21918 17.9688 7.91253 17.9688 7.53425C17.9688 7.15597 18.3185 6.84932 18.75 6.84932C19.2827 6.84932 19.8065 6.72994 20.2718 6.50253C20.737 6.27511 21.1282 5.94721 21.4083 5.54995C21.6883 5.15269 21.8479 4.69927 21.8718 4.23274C21.8958 3.7662 21.7833 3.30205 21.5451 2.88435C21.3069 2.46665 20.9508 2.10926 20.5107 1.84614C20.0707 1.58301 19.5612 1.42287 19.0306 1.38093C18.5001 1.339 17.9662 1.41664 17.4795 1.60651C16.9928 1.79637 16.5696 2.09215 16.25 2.46575C15.9911 2.76838 15.5014 2.82971 15.1562 2.60274C14.8111 2.37577 14.7411 1.94646 15 1.64384C15.4794 1.08343 16.1143 0.639765 16.8443 0.354968Z" />
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M17.9688 9.58904C17.9688 9.21077 18.3185 8.90411 18.75 8.90411C20.4076 8.90411 21.9973 9.48141 23.1694 10.509C24.3415 11.5366 25 12.9303 25 14.3836C25 14.7618 24.6502 15.0685 24.2188 15.0685H19.5312C19.0998 15.0685 18.75 14.7618 18.75 14.3836C18.75 14.0053 19.0998 13.6986 19.5312 13.6986H23.372C23.2108 12.8628 22.7573 12.085 22.0646 11.4776C21.1855 10.7069 19.9932 10.274 18.75 10.274C18.3185 10.274 17.9688 9.96732 17.9688 9.58904Z" />
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M5.82904 0.0166068C6.62482 -0.0463026 7.42574 0.0701711 8.15574 0.354968C8.88574 0.639765 9.52059 1.08343 10 1.64384C10.2589 1.94646 10.1889 2.37577 9.84375 2.60274C9.49857 2.82971 9.00888 2.76838 8.75 2.46575C8.43039 2.09215 8.00716 1.79637 7.5205 1.60651C7.03383 1.41664 6.49988 1.339 5.96936 1.38093C5.43883 1.42287 4.92934 1.58301 4.48927 1.84614C4.04919 2.10926 3.69314 2.46665 3.45491 2.88435C3.21669 3.30205 3.10422 3.7662 3.12816 4.23274C3.1521 4.69927 3.31167 5.15269 3.59172 5.54995C3.87176 5.94721 4.26298 6.27511 4.72824 6.50253C5.19349 6.72994 5.71732 6.84932 6.25 6.84932C6.68147 6.84932 7.03125 7.15597 7.03125 7.53425C7.03125 7.91253 6.68147 8.21918 6.25 8.21918C5.45098 8.21918 4.66523 8.04012 3.96735 7.69899C3.26948 7.35787 2.68264 6.86602 2.26257 6.27013C1.84251 5.67424 1.60315 4.99411 1.56724 4.29431C1.53132 3.59451 1.70004 2.89828 2.05737 2.27173C2.4147 1.64517 2.94878 1.1091 3.6089 0.71441C4.26901 0.31972 5.03325 0.0795162 5.82904 0.0166068Z" />
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M1.83058 10.509C3.00268 9.48141 4.5924 8.90411 6.25 8.90411C6.68147 8.90411 7.03125 9.21077 7.03125 9.58904C7.03125 9.96732 6.68147 10.274 6.25 10.274C5.0068 10.274 3.81451 10.7069 2.93544 11.4776C2.24271 12.085 1.78919 12.8628 1.62804 13.6986H5.46875C5.90022 13.6986 6.25 14.0053 6.25 14.3836C6.25 14.7618 5.90022 15.0685 5.46875 15.0685H0.78125C0.57405 15.0685 0.375336 14.9963 0.228823 14.8679C0.08231 14.7394 0 14.5652 0 14.3836C0 12.9303 0.65848 11.5366 1.83058 10.509Z" />
                    </svg>
                    <span>Users Area</span>
                </a>
                <a href="/admin/student/list" class="header-nav-item" id="student-list" title="Student List">
                    <svg width="25" height="20" viewBox="0 0 25 20">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M12.1324 0.0928793C12.3621 -0.0309597 12.6379 -0.0309597 12.8676 0.0928793L24.5864 6.40867C24.841 6.54587 25 6.8137 25 7.10526C25 7.39682 24.841 7.66465 24.5864 7.80186L12.8676 14.1176C12.6379 14.2415 12.3621 14.2415 12.1324 14.1176L0.413603 7.80186C0.159022 7.66465 0 7.39682 0 7.10526C0 6.8137 0.159022 6.54587 0.413603 6.40867L12.1324 0.0928793ZM2.44141 7.10526L12.5 12.5263L22.5586 7.10526L12.5 1.68421L2.44141 7.10526Z" />
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M5.46875 8.8421C5.90022 8.8421 6.25 9.19556 6.25 9.63158V15C6.25 15.1967 6.34252 15.4921 6.6304 15.8592C6.91325 16.22 7.34774 16.6002 7.92148 16.948C9.0682 17.6433 10.6868 18.1579 12.5 18.1579C14.3132 18.1579 15.9318 17.6433 17.0785 16.948C17.6523 16.6002 18.0867 16.22 18.3696 15.8592C18.6575 15.4921 18.75 15.1967 18.75 15V9.63158C18.75 9.19556 19.0998 8.8421 19.5312 8.8421C19.9627 8.8421 20.3125 9.19556 20.3125 9.63158V15C20.3125 15.6717 20.0144 16.304 19.5943 16.8398C19.1691 17.382 18.5782 17.8801 17.8824 18.302C16.4901 19.1462 14.5931 19.7368 12.5 19.7368C10.4069 19.7368 8.50992 19.1462 7.11758 18.302C6.42179 17.8801 5.83089 17.382 5.40573 16.8398C4.9856 16.304 4.6875 15.6717 4.6875 15V9.63158C4.6875 9.19556 5.03728 8.8421 5.46875 8.8421Z" />
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M24.2188 6.31579C24.6502 6.31579 25 6.66925 25 7.10526V17.3684C25 17.8044 24.6502 18.1579 24.2188 18.1579C23.7873 18.1579 23.4375 17.8044 23.4375 17.3684V7.10526C23.4375 6.66925 23.7873 6.31579 24.2188 6.31579Z" />
                    </svg>
                    <span>Student List</span>
                </a>
                <a href="/admin/student" class="header-nav-item" id="reload-ins" title="INs">
                    <svg width="20" height="20" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M14.8286 11.6624C15.094 11.3705 15.5457 11.349 15.8376 11.6143L19.7662 15.1858C19.9151 15.3211 20 15.513 20 15.7143C20 15.9155 19.9151 16.1074 19.7662 16.2428L15.8376 19.8142C15.5457 20.0796 15.094 20.0581 14.8286 19.7662C14.5633 19.4743 14.5848 19.0225 14.8767 18.7572L18.2239 15.7143L14.8767 12.6714C14.5848 12.406 14.5633 11.9543 14.8286 11.6624Z" />
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M0 15.7143C0 15.3198 0.319797 15 0.714286 15H19.2857C19.6802 15 20 15.3198 20 15.7143C20 16.1088 19.6802 16.4286 19.2857 16.4286H0.714286C0.319797 16.4286 0 16.1088 0 15.7143Z" />
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M5.17139 0.23381C5.43675 0.525708 5.41524 0.977457 5.12334 1.24282L1.77615 4.28572L5.12334 7.32862C5.41524 7.59398 5.43675 8.04573 5.17139 8.33762C4.90602 8.62952 4.45428 8.65103 4.16238 8.38567L0.233805 4.81425C0.0848949 4.67887 0 4.48696 0 4.28572C0 4.08447 0.0848949 3.89256 0.233805 3.75719L4.16238 0.185762C4.45428 -0.0795999 4.90602 -0.0580881 5.17139 0.23381Z" />
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M0 4.28572C0 3.89123 0.319797 3.57143 0.714286 3.57143H19.2857C19.6802 3.57143 20 3.89123 20 4.28572C20 4.68021 19.6802 5 19.2857 5H0.714286C0.319797 5 0 4.68021 0 4.28572Z" />
                    </svg>
                    <span>INs</span>
                </a>
            </div>
            <div class="nav-right-side">
                <% if(locals.loggedAdmin) { %>
                    <span class="admin-name"><%= loggedAdmin.name %></span>
                    <span class="admin-separator">|</span>
                    <span class="admin-email"><%= loggedAdmin.location %></span>
                <% } %>
            </div>
        </nav>      <!-- header-center-item -->
        <!-- SIGN OUT element -->
        <form class="header-right-item" action="/admin/logout" method="POST">
            <button type="submit">
                <svg width="25" height="21" viewBox="0 0 25 21">
                    <path d="M10.2041 18.8964C10.2041 18.939 10.2094 19.0454 10.22 19.2156C10.2307 19.3859 10.2333 19.5268 10.228 19.6386C10.2227 19.7503 10.2067 19.8753 10.1802 20.0136C10.1536 20.1519 10.1004 20.2557 10.0207 20.3248C9.94101 20.394 9.83206 20.4286 9.69388 20.4286H4.59184C3.32696 20.4286 2.24543 19.979 1.34726 19.08C0.449086 18.1809 0 17.0983 0 15.8321V4.59643C0 3.33028 0.449086 2.24767 1.34726 1.3486C2.24543 0.449535 3.32696 0 4.59184 0H9.69388C9.83206 0 9.95164 0.0505394 10.0526 0.151618C10.1536 0.252697 10.2041 0.372396 10.2041 0.510714C10.2041 0.553274 10.2094 0.659673 10.22 0.829911C10.2307 1.00015 10.2333 1.14113 10.228 1.25285C10.2227 1.36456 10.2067 1.48958 10.1802 1.6279C10.1536 1.76622 10.1004 1.86996 10.0207 1.93912C9.94101 2.00828 9.83206 2.04286 9.69388 2.04286H4.59184C3.89031 2.04286 3.28975 2.29289 2.79018 2.79297C2.2906 3.29304 2.04082 3.8942 2.04082 4.59643V15.8321C2.04082 16.5344 2.2906 17.1355 2.79018 17.6356C3.28975 18.1357 3.89031 18.3857 4.59184 18.3857H9.56633L9.74968 18.4017L9.93304 18.4496L10.0606 18.5373L10.1722 18.681L10.2041 18.8964ZM25 10.2143C25 10.4909 24.899 10.7303 24.6971 10.9325L16.0236 19.6146C15.8216 19.8168 15.5825 19.9179 15.3061 19.9179C15.0298 19.9179 14.7906 19.8168 14.5886 19.6146C14.3867 19.4125 14.2857 19.1731 14.2857 18.8964V14.3H7.14286C6.8665 14.3 6.62734 14.1989 6.42538 13.9968C6.22343 13.7946 6.12245 13.5552 6.12245 13.2786V7.15C6.12245 6.87336 6.22343 6.63397 6.42538 6.43181C6.62734 6.22965 6.8665 6.12857 7.14286 6.12857H14.2857V1.53214C14.2857 1.25551 14.3867 1.01611 14.5886 0.813951C14.7906 0.611793 15.0298 0.510714 15.3061 0.510714C15.5825 0.510714 15.8216 0.611793 16.0236 0.813951L24.6971 9.49609C24.899 9.69825 25 9.93765 25 10.2143Z" />
                </svg>
            </button>
        </form>     <!-- header-right-item -->
    </header>


    <div class="main-box">
        <% if(locals.user) { %>
            <section class="main-box-header">
                <div class="student-top-info-box">
                    <%
                        let fullName = "New User"
                        if (user.dataCollection) {
                            fullName = user.dataCollection.firstName.toLowerCase() !== "n/a" ? user.dataCollection.firstName + " " : ""
                            fullName += user.dataCollection.lastName.toLowerCase() !== "n/a" ? user.dataCollection.lastName + " " : ""
                        }
                    %>
                    <h2 class="student-full-name"><%= fullName %></h2>
                    
                    <div class="student-top-inner-box">
                        <div class="student-top-info-item">
                            <span class="student-top-info-title">Nickname</span>
                            <span class="student-top-info-value"><%= user.name.charAt(0).toUpperCase() + user.name.slice(1).toLowerCase() %></span>
                        </div>
                        <div class="student-top-info-item">
                            <span class="student-top-info-title">Profile created</span>
                            <span class="student-top-info-value"><%= new Date(user.created).toLocaleDateString("en-CA", { timeZone: locals.SCHOOL_DATA.tZONE }) %></span>
                        </div>
                        <div class="student-top-info-item">
                            <span class="student-top-info-title">Last session</span>
                            <span class="student-top-info-value"><%= new Date(user.lastSESS).toLocaleDateString("en-CA", { timeZone: locals.SCHOOL_DATA.tZONE }) %>, <%= new Date(user.lastSESS).toLocaleTimeString("en-US", { timeZone: locals.SCHOOL_DATA.tZONE, hour12: false }) %></span>
                        </div>
                    </div>      <!-- student-top-inner-box -->
    
                    <!-- hidden back link, for getting back -->
                    <a class="-hidden" id="for-getting-back" href="/admin/user/<%= user._id %>" data-user="<%= user._id %>"></a>  <!-- this link is used for getting back to correct PAGE after PUT request -->
    
                    <!-- toolbar: block/unblock/delete -->
                    <menu type="toolbar" class="toolbar-box">
                        <div class="toolbar-btn" onclick="menuAction('unblock')" title="Unblock student (Allow Clocking)">
                            <svg width="13" height="18" viewBox="0 0 13 18">
                                <path d="M13 9L0 0V18L13 9Z" />
                            </svg>
                        </div>
                        <div class="toolbar-btn" onclick="menuAction('block')" title="Block student (Unable Clocking)">
                            <svg width="14" height="17" viewBox="0 0 14 17">
                                <rect x="0" width="6" height="17" />
                                <rect x="8" width="6" height="17" />
                            </svg>
                        </div>
                        <div class="toolbar-btn" onclick="menuAction('archive')" id="archive-menu-item" title="Move to Archive">
                            <svg width="22" height="17" viewBox="0 0 22 17">
                                <path d="M0 0H22V3.92308H0V0Z" />
                                <path d="M6.875 6.53846H1.375V17H20.625V6.53846H15.125V9.15385H6.875V6.53846Z" />
                            </svg>
                        </div>
                        <div class="toolbar-btn -delete" onclick="menuAction('delete')" title="Delete without Archiving">
                            <svg width="18" height="18" viewBox="0 0 18 18">
                                <path d="M17.9195 3.84876L12.8021 8.96613L17.9534 14.1174L14.1595 17.9113L9.00823 12.76L3.92027 17.848L0.223503 14.1512L5.31146 9.06328L0.160227 3.91204L3.95414 0.118126L9.10538 5.26936L14.2227 0.151993L17.9195 3.84876Z" />
                            </svg>
                        </div>
                    </menu>
                </div>      <!-- student-top-info-box -->

                <div class="main-box-comment">
                    <textarea id="mainComment" type="text" data-oldvalue="<%= user.comment %>" oninput="checkInput(this, mainSaveComment)" placeholder="comment"><%= user.comment %></textarea>
                    <span id="mainSaveComment" class="show-edit-btn" onclick="saveComment(mainComment, this)">Save</span>
                </div>  <!-- firstName -->

                <!-- script for comments managing -->
                <script defer>
                    // show if changed
                    function checkInput(comment, btn) {
                        if (!comment) { return }
                        comment.classList.toggle("-changed", comment.value != comment.dataset.oldvalue)
                        if (btn) {
                            btn.classList.toggle("-changed", comment.value != comment.dataset.oldvalue)
                        }
                    }
                    // fetch PUT to save comment
                    async function saveComment(comment, btn) {
                        if (!comment) { return }
                        if (!comment.value) { return }
                        if (comment.value === comment.dataset.oldvalue) { return }
                        const response = await fetch("/admin/user", {
                            method: "PUT",
                            headers: { "Content-Type": "application/json" },
                            body: JSON.stringify({
                                userId: "<%= user._id %>",
                                comment: comment.value,
                                action: "update-comment"
                            })
                        })
                        if (response.status > 200) {
                            response.json()
                            .then(res => {
                                alert(`Issue: ${res.issue}`)
                            })
                        } else {
                            alert("Your comment has been saved")
                            comment.dataset.oldvalue = comment.value
                            comment.classList.remove("-changed")
                            if (btn) {
                                btn.classList.remove("-changed")
                            }
                        }
                    }
                </script>

            </section>      <!-- main-box-header -->
        <% } %>


        <nav class="nav-menu">
            <div class="block-title" name="block1" onclick="toggleBlock(this)">Data Collection</div>
            <div class="block-title" name="block2" onclick="toggleBlock(this)">Application</div>
            <div class="block-title" name="block3" onclick="toggleBlock(this)">Agreement</div>
            <div class="block-title" name="block4" onclick="toggleBlock(this)">Student Data</div>
            <div class="block-title" name="block5" onclick="toggleBlock(this)">Graduate</div>
            <div class="rest-empty-box"></div>
        </nav>

        
        <section class="block-box -hidden" name="blockBox" id="block1">
            <!-- dataCollection info more data -->
            <% if(user.dataCollection) { %>
                <form action="/admin/update-form1/<%= user.dataCollection._id %>" method="post" class="block-box-inner" id="form1">
                    <input type="hidden" name="postedPath" value="/admin/user/<%= user._id %>?activatetab=1" />       <!-- path for getting back after updating -->
                    <div class="block-box-left">
                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">First Name</div>
                                <div class="field-value"><%= user.dataCollection.firstName %></div>
                            </div>
                            <div class="edit-set -hidden" name="data-coll-edits" data-id="firstName">
                                <input class="input-box" type="text" name="firstName" id="firstName" />
                                <label class="show-edit-btn" for="firstName" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="firstName" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- firstName -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">Last Name</div>
                                <div class="field-value"><%= user.dataCollection.lastName %></div>
                            </div>
                            <div class="edit-set -hidden" name="data-coll-edits" data-id="lastName">
                                <input class="input-box" type="text" name="lastName" id="lastName"/>
                                <label class="show-edit-btn" for="lastName" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="lastName" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- lastName -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">Middle Name</div>
                                <div class="field-value"><%= user.dataCollection.middleName %></div>
                            </div>
                            <div class="edit-set -hidden" name="data-coll-edits" data-id="middleName">
                                <input class="input-box" type="text" name="middleName" id="middleName"/>
                                <label class="show-edit-btn" for="middleName" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="middleName" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- middleName -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">Street Address</div>
                                <div class="field-value"><%= user.dataCollection.street %></div>
                            </div>
                            <div class="edit-set -hidden" name="data-coll-edits" data-id="street">
                                <input class="input-box" type="text" name="street" id="street"/>
                                <label class="show-edit-btn" for="street" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="street" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- street -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">City</div>
                                <div class="field-value"><%= user.dataCollection.city %></div>
                            </div>
                            <div class="edit-set -hidden" name="data-coll-edits" data-id="city">
                                <input class="input-box" type="text" name="city" id="city"/>
                                <label class="show-edit-btn" for="city" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="city" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- city -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">State/Province/Region</div>
                                <div class="field-value"><%= user.dataCollection.state %></div>
                            </div>
                            <div class="edit-set -hidden" name="data-coll-edits" data-id="state">
                                <select autocomplete="off" class="input-box" name="state" id="state">
                                    <option value="DNU">do not update</option>
                                    <optgroup label="locations">
                                        <option value="Washington">Washington</option>
                                    </optgroup>
                                    <option value="Alaska">Alaska</option>
                                    <option value="Alabama">Alabama</option>
                                    <option value="Arkansas">Arkansas</option>
                                    <option value="Arizona">Arizona</option>
                                    <option value="California">California</option>
                                    <option value="Colorado">Colorado</option>
                                    <option value="Connecticut">Connecticut</option>
                                    <option value="Washington DC">Washington DC</option>
                                    <option value="Delaware">Delaware</option>
                                    <option value="Florida">Florida</option>
                                    <option value="Georgia">Georgia</option>
                                    <option value="Hawaii">Hawaii</option>
                                    <option value="Iowa">Iowa</option>
                                    <option value="Idaho">Idaho</option>
                                    <option value="Illinois">Illinois</option>
                                    <option value="Indiana">Indiana</option>
                                    <option value="Kansas">Kansas</option>
                                    <option value="Kentucky">Kentucky</option>
                                    <option value="Louisiana">Louisiana</option>
                                    <option value="Massachusetts">Massachusetts</option>
                                    <option value="Maryland">Maryland</option>
                                    <option value="Maine">Maine</option>
                                    <option value="Michigan">Michigan</option>
                                    <option value="Minnesota">Minnesota</option>
                                    <option value="Missouri">Missouri</option>
                                    <option value="Mississippi">Mississippi</option>
                                    <option value="Montana">Montana</option>
                                    <option value="North Carolina">North Carolina</option>
                                    <option value="North Dakota">North Dakota</option>
                                    <option value="Nebraska">Nebraska</option>
                                    <option value="New Hampshire">New Hampshire</option>
                                    <option value="New Jersey">New Jersey</option>
                                    <option value="New Mexico">New Mexico</option>
                                    <option value="Nevada">Nevada</option>
                                    <option value="New York">New York</option>
                                    <option value="Ohio">Ohio</option>
                                    <option value="Oklahoma">Oklahoma</option>
                                    <option value="Oregon">Oregon</option>
                                    <option value="Pennsylvania">Pennsylvania</option>
                                    <option value="Rhode Island">Rhode Island</option>
                                    <option value="South Carolina">South Carolina</option>
                                    <option value="South Dakota">South Dakota</option>
                                    <option value="Tennessee">Tennessee</option>
                                    <option value="Texas">Texas</option>
                                    <option value="Utah">Utah</option>
                                    <option value="Virginia">Virginia</option>
                                    <option value="Vermont">Vermont</option>
                                    <option value="Wisconsin">Wisconsin</option>
                                    <option value="West Virginia">West Virginia</option>
                                    <option value="Wyoming">Wyoming</option>
                                </select>
                                <label class="show-edit-btn" for="state" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="state" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- state -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">Postal/Zip Code</div>
                                <div class="field-value"><%= user.dataCollection.zip %></div>
                            </div>
                            <div class="edit-set -hidden" name="data-coll-edits" data-id="zip">
                                <input class="input-box" type="number" min=0 name="zip" id="zip" />
                                <label class="show-edit-btn" for="zip" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="zip" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- zip -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">Phone Number</div>
                                <a class="field-link" href="tel:<%= user.dataCollection.phone %>"><%= user.dataCollection.phone %></a>
                            </div>
                            <div class="edit-set -hidden" name="data-coll-edits" data-id="phone">
                                <input class="input-box" type="number" min=0 name="phone" id="phone" pattern="[0-9]{10}" title="10 digits of your phone number">
                                <label class="show-edit-btn" for="phone" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="phone" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- phone -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">Email</div>
                                <% if (user.token === "not sent") { %>
                                    <div class="field-link -unsafe"><%= user.email %></div>
                                    <span class="email-unsafe">!</span>
                                <% } else { %>
                                    <% if (user.token === "verified") { %>
                                        <span class="field-value"><%= user.tokenDetails %></span>
                                        <a class="field-link" href="mailto:<%= user.email %>"><%= user.email %></a>
                                    <% } else { %>
                                        <div class="field-link -unsafe"><%= user.email %></div>
                                        <span class="email-unsafe">!</span>
                                    <% } %>
                                <% } %>
                            </div>
                        </section>  <!-- email -->
                    </div>      <!-- block-box-left -->

                    <div class="block-box-right">
                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">Date of birth</div>
                                <!-- DOB without timeZone, because of specific of saving -->
                                <div class="field-value"><%= new Date(user.dataCollection.DOB).toLocaleDateString("en-CA") %></div>
                            </div>
                            <div class="edit-set -hidden" name="data-coll-edits" data-id="DOB">
                                <input class="input-box" type="date" name="DOB" id="DOB">
                                <label class="show-edit-btn" for="DOB" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="DOB" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- Date of birth -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">Social Security Number</div>
                                <div class="field-value"><%= user.dataCollection.SSN %></div>
                            </div>
                            <div class="edit-set -hidden" name="data-coll-edits" data-id="SSN">
                                <input class="input-box" type="number" name="SSN" id="SSN" pattern="[0-9]{9}" title="9 digits SSN">
                                <label class="show-edit-btn" for="SSN" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="SSN" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- SSN -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">race</div>
                                <div class="field-value"><%= user.dataCollection.race %></div>
                            </div>
                            <div class="edit-set -hidden" name="data-coll-edits" data-id="race">
                                <select class="input-box" name="race" id="race">
                                    <option value="DNU">do not update</option>
                                    <optgroup label="top used">
                                        <option value="White/Caucasian">White/Caucasian</option>
                                    </optgroup>
                                    <option value="Black/African American">Black/African American</option>
                                    <option value="American Indian or Alaska Native">American Indian or Alaska Native</option>
                                    <option value="Hawaiian Native or other Pacific Islander">Hawaiian Native or other Pacific Islander</option>
                                    <option value="Asian">Asian</option>
                                    <option value="Multiracial">Multiracial</option>
                                    <option value="Other">Other</option>
                                </select>
                                <label class="show-edit-btn" for="race" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="race" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- race -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">hispanic</div>
                                <div class="field-value"><%= user.dataCollection.hispanic %></div>
                            </div>
                            <div class="edit-set -hidden" name="data-coll-edits" data-id="hispanic">
                                <select class="input-box" name="hispanic" id="hispanic">
                                    <option value="DNU">do not update</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                                <label class="show-edit-btn" for="hispanic" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="hispanic" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- race -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">disabled</div>
                                <div class="field-value"><%= user.dataCollection.disabled %></div>
                            </div>
                            <div class="edit-set -hidden" name="data-coll-edits" data-id="disabled">
                                <select class="input-box" name="disabled" id="disabled">
                                    <option value="DNU">do not update</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                                <label class="show-edit-btn" for="disabled" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="disabled" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- disabled -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">veteran</div>
                                <div class="field-value"><%= user.dataCollection.veteran %></div>
                            </div>
                            <div class="edit-set -hidden" name="data-coll-edits" data-id="veteran">
                                <select class="input-box" name="veteran" id="veteran">
                                    <option value="DNU">do not update</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                                <label class="show-edit-btn" for="veteran" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="veteran" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- veteran -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">gender</div>
                                <div class="field-value"><%= user.dataCollection.sex %></div>
                            </div>
                            <div class="edit-set -hidden" name="data-coll-edits" data-id="sex">
                                <select class="input-box" name="sex" id="sex">
                                    <option value="DNU">do not update</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                </select>
                                <label class="show-edit-btn" for="sex" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="sex" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- sex -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">education level</div>
                                <div class="field-value"><%= user.dataCollection.grade %></div>
                            </div>
                            <div class="edit-set -hidden" name="data-coll-edits" data-id="grade">
                                <select class="input-box" name="grade" id="grade">
                                    <option value="DNU">do not update</option>
                                    <option value="Less than high school graduation">Less than high school graduation</option>
                                    <option value="High school graduate">High school graduate</option>
                                    <option value="GED">GED</option>
                                    <option value="Some post high school, no degree/certificate">Some post high school, no degree/certificate</option>
                                    <option value="Certificate (less than two years)">Certificate (less than two years)</option>
                                    <option value="Associate’s Degree">Associate’s Degree</option>
                                    <option value="Bachelor’s Degree">Bachelor’s Degree</option>
                                    <option value="Master’s Degree">Master’s Degree</option>
                                </select>
                                <label class="show-edit-btn" for="grade" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="grade" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- grade -->
                    </div>      <!-- block-box-right -->

                    <!-- contains all updated MODELS fields -->
                    <input type="hidden" name="whatWasUpdated"  data-updated="data-coll-edits" />


                    <div class="block-box-left">
                        <!-- @SIGNATURE -->
                        <section class="row-item">
                            <div class="field-title">completed as of</div>
                            <div class="field-value -left-just"><%= new Date(user.dataCollection.created).toLocaleDateString("en-CA", { timeZone: locals.SCHOOL_DATA.tZONE }) %> (<%= new Date(user.dataCollection.created).toLocaleTimeString("en-US", { timeZone: locals.SCHOOL_DATA.tZONE, hour12: false }) %>)</div>
                        </section>
                        <!-- @ADMIN CHANGED -->
                        <% if(user.dataCollection.updatedAdmin) { %>
                            <%
                                let updater = user.dataCollection.updatedAdmin + " "
                                updater += new Date(user.dataCollection.updatedDate).toLocaleDateString("en-CA", { timeZone: locals.SCHOOL_DATA.tZONE })
                                updater += "(" + new Date(user.dataCollection.updatedDate).toLocaleTimeString("en-US", { timeZone: locals.SCHOOL_DATA.tZONE, hour12: false }) + ")"
                            %>
                            <section class="row-item">
                                <div class="field-title">updated by</div>
                                <div class="field-value"><%= updater %></div>
                            </section>
                        <% } %>
                    </div>
                    <div class="block-box-right">
                        <!-- @BUTTONS -->
                        <section class="row-buttons">
                            <a class="-btn" href="/admin/print-form/<%= user._id %>?form=form1">Print</a>
                            <button type="submit" class="-btn">Update</button>
                        </section>
                    </div>

                </form>   <!-- block1 -->
            <% } else { %>
                <div class="field-info">Data Collection form is not completed yet.</div>
                <div class="field-info1">Data Collection is one of the <span class="field-info2">basic state required</span> enrollment forms. User should start with one to become an Applicant...</div>
                <div class="field-info1">First of all, Users have to create their account and go through procedure of email verification to make forms available.</div>
            <% } %>     <!-- if(user.dataCollection) -->
        </section>  <!-- block-box -->



        
        <!-- @APPLICATION FORM  id=block2 -->
        <!-- EDIT group "appl-edits" -->

        <section class="block-box -hidden" name="blockBox" id="block2">
            <% if(user.application) { %>
                <form action="/admin/update-form2/<%= user.application._id %>" method="post" class="block-box-inner" id="form2">
                    <input type="hidden" name="postedPath" value="/admin/user/<%= user._id %>?activatetab=2" />       <!-- path for getting back after updating -->
                    <div class="block-box-left">

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">Attraction Channel</div>
                                <div class="field-value"><%= user.application.channel %></div>
                            </div>
                            <div class="edit-set -hidden" name="appl-edits" data-id="hdyfu">
                                <select class="input-box" name="hdyfu" id="hdyfu" required>
                                    <option value="DNU">do not update</option>
                                    <option value="Google Search">Google Search</option>
                                    <option value="Vehicle Wrap Advertising">Vehicle Wrap Advertising</option>
                                    <option value="Outdoor Advertising">Outdoor Advertising</option>
                                    <option value="Walk In">Walk In</option>
                                    <option value="Social Media">Social Media</option>
                                    <option value="Personal Referral">Personal Referral</option>
                                </select>
                                <label class="show-edit-btn" for="hdyfu" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="hdyfu" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- hdyfu -->

                        <!-- Emergency Info -->
                        <div class="field-subheader-red">EMERGENCY CONTACTS</div>
                        
                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">Emergency Contact</div>
                                <div class="field-value"><%= user.application["emerg-person-name"] %></div>
                            </div>
                            <div class="edit-set -hidden" name="appl-edits" data-id="emerg-person-name">
                                <input class="input-box" type="text" name="emerg-person-name" id="emerg-person-name">
                                <label class="show-edit-btn" for="emerg-person-name" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="emerg-person-name" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- emerg-person-name -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">Phone Number</div>
                                <a class="field-link" href="tel:<%= user.application['emerg-person-phone'] %>"><%= user.application["emerg-person-phone"] %></a>
                            </div>
                            <div class="edit-set -hidden" name="appl-edits" data-id="emerg-person-phone">
                                <input class="input-box" type="number" min=0 name="emerg-person-phone" id="emerg-person-phone" pattern="[0-9]{10}" title="10 digits phone number">
                                <label class="show-edit-btn" for="emerg-person-phone" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="emerg-person-phone" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- emerg-person-phone -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">Relationship</div>
                                <div class="field-value"><%= user.application["emerg-person-relation"] %></div>
                            </div>
                            <div class="edit-set -hidden" name="appl-edits" data-id="emerg-person-relation">
                                <input class="input-box" type="text" name="emerg-person-relation" id="emerg-person-relation">
                                <label class="show-edit-btn" for="emerg-person-relation" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="emerg-person-relation" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- emerg-person-relation -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">Street</div>
                                <div class="field-value"><%= user.application["emerg-person-street"] %></div>
                            </div>
                            <div class="edit-set -hidden" name="appl-edits" data-id="emerg-person-street">
                                <input class="input-box" type="text" name="emerg-person-street" id="emerg-person-street">
                                <label class="show-edit-btn" for="emerg-person-street" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="emerg-person-street" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- emerg-person-street -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">City</div>
                                <div class="field-value"><%= user.application["emerg-person-city"] %></div>
                            </div>
                            <div class="edit-set -hidden" name="appl-edits" data-id="emerg-person-city">
                                <input class="input-box" type="text" name="emerg-person-city" id="emerg-person-city">
                                <label class="show-edit-btn" for="emerg-person-city" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="emerg-person-city" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- emerg-person-city -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">State</div>
                                <div class="field-value"><%= user.application["emerg-person-state"] %></div>
                            </div>
                            <div class="edit-set -hidden" name="appl-edits" data-id="emerg-person-state">
                                <select autocomplete="off" class="input-box" name="emerg-person-state" id="emerg-person-state">
                                    <option value="DNU">do not update</option>
                                    <optgroup label="locations">
                                        <option value="Washington">Washington</option>
                                    </optgroup>
                                    <option value="Alaska">Alaska</option>
                                    <option value="Alabama">Alabama</option>
                                    <option value="Arkansas">Arkansas</option>
                                    <option value="Arizona">Arizona</option>
                                    <option value="California">California</option>
                                    <option value="Colorado">Colorado</option>
                                    <option value="Connecticut">Connecticut</option>
                                    <option value="Washington DC">Washington DC</option>
                                    <option value="Delaware">Delaware</option>
                                    <option value="Florida">Florida</option>
                                    <option value="Georgia">Georgia</option>
                                    <option value="Hawaii">Hawaii</option>
                                    <option value="Iowa">Iowa</option>
                                    <option value="Idaho">Idaho</option>
                                    <option value="Illinois">Illinois</option>
                                    <option value="Indiana">Indiana</option>
                                    <option value="Kansas">Kansas</option>
                                    <option value="Kentucky">Kentucky</option>
                                    <option value="Louisiana">Louisiana</option>
                                    <option value="Massachusetts">Massachusetts</option>
                                    <option value="Maryland">Maryland</option>
                                    <option value="Maine">Maine</option>
                                    <option value="Michigan">Michigan</option>
                                    <option value="Minnesota">Minnesota</option>
                                    <option value="Missouri">Missouri</option>
                                    <option value="Mississippi">Mississippi</option>
                                    <option value="Montana">Montana</option>
                                    <option value="North Carolina">North Carolina</option>
                                    <option value="North Dakota">North Dakota</option>
                                    <option value="Nebraska">Nebraska</option>
                                    <option value="New Hampshire">New Hampshire</option>
                                    <option value="New Jersey">New Jersey</option>
                                    <option value="New Mexico">New Mexico</option>
                                    <option value="Nevada">Nevada</option>
                                    <option value="New York">New York</option>
                                    <option value="Ohio">Ohio</option>
                                    <option value="Oklahoma">Oklahoma</option>
                                    <option value="Oregon">Oregon</option>
                                    <option value="Pennsylvania">Pennsylvania</option>
                                    <option value="Rhode Island">Rhode Island</option>
                                    <option value="South Carolina">South Carolina</option>
                                    <option value="South Dakota">South Dakota</option>
                                    <option value="Tennessee">Tennessee</option>
                                    <option value="Texas">Texas</option>
                                    <option value="Utah">Utah</option>
                                    <option value="Virginia">Virginia</option>
                                    <option value="Vermont">Vermont</option>
                                    <option value="Wisconsin">Wisconsin</option>
                                    <option value="West Virginia">West Virginia</option>
                                    <option value="Wyoming">Wyoming</option>
                                </select>
                                <label class="show-edit-btn" for="emerg-person-state" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="emerg-person-state" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- emerg-person-state -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">Zip</div>
                                <div class="field-value"><%= user.application["emerg-person-zip"] %></div>
                            </div>
                            <div class="edit-set -hidden" name="appl-edits" data-id="emerg-person-zip">
                                <input class="input-box" type="number" min=0 name="emerg-person-zip" id="emerg-person-zip">
                                <label class="show-edit-btn" for="emerg-person-zip" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="emerg-person-zip" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- emerg-person-zip -->


                        <!-- License info -->
                        <div class="field-subheader-black">MOTOR VEHICLE LICENSES HELD</div>
                        
                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">License</div>
                                <div class="field-value"><%= user.application["vehicle-license"].toUpperCase() %></div>
                            </div>
                            <div class="edit-set -hidden" name="appl-edits" data-id="vehicle-license">
                                <input class="input-box" type="text" name="vehicle-license" id="vehicle-license">
                                <label class="show-edit-btn" for="vehicle-license" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="vehicle-license" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- vehicle-license -->

                        <section class="row-item">
                            <div class="fields-set">
                                <div class="field-title">State</div>
                                <div class="field-value"><%= user.application["vehicle-license-state"] %></div>
                            </div>
                            <div class="edit-set -hidden" name="appl-edits" data-id="vehicle-license-state">
                                <select autocomplete="off" class="input-box" name="vehicle-license-state" id="vehicle-license-state">
                                    <option value="DNU">do not update</option>
                                    <optgroup label="locations">
                                        <option value="Washington">Washington</option>
                                    </optgroup>
                                    <option value="Alaska">Alaska</option>
                                    <option value="Alabama">Alabama</option>
                                    <option value="Arkansas">Arkansas</option>
                                    <option value="Arizona">Arizona</option>
                                    <option value="California">California</option>
                                    <option value="Colorado">Colorado</option>
                                    <option value="Connecticut">Connecticut</option>
                                    <option value="Washington DC">Washington DC</option>
                                    <option value="Delaware">Delaware</option>
                                    <option value="Florida">Florida</option>
                                    <option value="Georgia">Georgia</option>
                                    <option value="Hawaii">Hawaii</option>
                                    <option value="Iowa">Iowa</option>
                                    <option value="Idaho">Idaho</option>
                                    <option value="Illinois">Illinois</option>
                                    <option value="Indiana">Indiana</option>
                                    <option value="Kansas">Kansas</option>
                                    <option value="Kentucky">Kentucky</option>
                                    <option value="Louisiana">Louisiana</option>
                                    <option value="Massachusetts">Massachusetts</option>
                                    <option value="Maryland">Maryland</option>
                                    <option value="Maine">Maine</option>
                                    <option value="Michigan">Michigan</option>
                                    <option value="Minnesota">Minnesota</option>
                                    <option value="Missouri">Missouri</option>
                                    <option value="Mississippi">Mississippi</option>
                                    <option value="Montana">Montana</option>
                                    <option value="North Carolina">North Carolina</option>
                                    <option value="North Dakota">North Dakota</option>
                                    <option value="Nebraska">Nebraska</option>
                                    <option value="New Hampshire">New Hampshire</option>
                                    <option value="New Jersey">New Jersey</option>
                                    <option value="New Mexico">New Mexico</option>
                                    <option value="Nevada">Nevada</option>
                                    <option value="New York">New York</option>
                                    <option value="Ohio">Ohio</option>
                                    <option value="Oklahoma">Oklahoma</option>
                                    <option value="Oregon">Oregon</option>
                                    <option value="Pennsylvania">Pennsylvania</option>
                                    <option value="Rhode Island">Rhode Island</option>
                                    <option value="South Carolina">South Carolina</option>
                                    <option value="South Dakota">South Dakota</option>
                                    <option value="Tennessee">Tennessee</option>
                                    <option value="Texas">Texas</option>
                                    <option value="Utah">Utah</option>
                                    <option value="Virginia">Virginia</option>
                                    <option value="Vermont">Vermont</option>
                                    <option value="Wisconsin">Wisconsin</option>
                                    <option value="West Virginia">West Virginia</option>
                                    <option value="Wyoming">Wyoming</option>
                                </select>
                                <label class="show-edit-btn" for="vehicle-license-state" onclick="cleanField(this)">Clear</label>
                            </div>
                            <label class="show-edit-btn" for="vehicle-license-state" onclick="toggleEditField(this)">Edit</label>
                        </section>  <!-- vehicle-license-state -->

                    </div>     <!-- block-box-left -->

                    <div class="block-box-right">
                        <!-- Referral Info -->
                        <details class="row-item" id="referral-details">   <!-- id is used for open details after backlink -->
                            <summary>Referral Person Info</summary>
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">Full Name</div>
                                    <div class="field-value"><%= user.application["ref-person-name"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="ref-person-name">
                                    <input class="input-box" type="text" name="ref-person-name" id="ref-person-name">
                                    <label class="show-edit-btn" for="ref-person-name" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="ref-person-name" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- ref-person-name -->
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">Phone Number(Zelle)</div>
                                    <div class="field-value -italic"><%= user.application["ref-person-phone"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="ref-person-phone">
                                    <input class="input-box" type="number" min=0 name="ref-person-phone" id="ref-person-phone" pattern="[0-9]{10}" title="10 digits phone number">
                                    <label class="show-edit-btn" for="ref-person-phone" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="ref-person-phone" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- ref-person-phone -->
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">Email Address(Zelle)</div>
                                    <div class="field-value -email -italic"><%= user.application["ref-person-email"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="ref-person-email">
                                    <input class="input-box" type="email" name="ref-person-email" id="ref-person-email" title="Zelle - based digital payments network. Can be used for prompt payments at Bank of America, BB&T, Capital One, JPMorgan Chase, PNC Bank, U.S. Bank and Wells Fargo.">
                                    <label class="show-edit-btn" for="ref-person-email" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="ref-person-email" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- ref-person-email -->
                        </details>

                        <!-- Education info -->
                        <details class="row-item" id="education-details">   <!-- id is used for open details after backlink -->
                            <summary>EDUCATION INFO</summary>
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">Highest Grade Completed</div>
                                    <div class="field-value"><%= user.application["education-highest-grade"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="education-highest-grade">
                                    <input class="input-box" type="number" min=1 max=12 name="education-highest-grade" id="education-highest-grade" title="MAX - 12">
                                    <label class="show-edit-btn" for="education-highest-grade" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="education-highest-grade" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- education-highest-grade -->

                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">College</div>
                                    <div class="field-value"><%= user.application["education-colledge"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="education-colledge">
                                    <input class="input-box" type="number" min=1 max=4 name="education-colledge" id="education-colledge" title="MAX-4">
                                    <label class="show-edit-btn" for="education-colledge" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="education-colledge" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- education-colledge -->

                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">High School Graduate?</div>
                                    <div class="field-value"><%= user.application.highSchoolGrade %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="highSchoolGrade">
                                    <select class="input-box" name="highSchoolGrade" id="highSchoolGrade">
                                        <option value="DNU">do not update</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                    <label class="show-edit-btn" for="highSchoolGrade" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="highSchoolGrade" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- highSchoolGrade -->

                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">Graduation or GED Completion Date</div>
                                    <div class="field-value"><%= new Date(user.application["education-grade-date"]).toLocaleDateString("en-US", { timeZone: locals.SCHOOL_DATA.tZONE }) %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="education-grade-date">
                                    <input class="input-box" type="date" name="education-grade-date" id="education-grade-date">
                                    <label class="show-edit-btn" for="education-grade-date" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="education-grade-date" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- education-grade-date -->

                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">Last School Attended</div>
                                    <div class="field-value"><%= user.application["education-last-school"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="education-last-school">
                                    <input class="input-box" type="text" name="education-last-school" id="education-last-school">
                                    <label class="show-edit-btn" for="education-last-school" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="education-last-school" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- education-last-school -->
        
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">Degrees/Certificates</div>
                                    <div class="field-value"><%= user.application["education-last-school-degree"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="education-last-school-degree">
                                    <input class="input-box" type="text" name="education-last-school-degree" id="education-last-school-degree">
                                    <label class="show-edit-btn" for="education-last-school-degree" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="education-last-school-degree" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- education-last-school-degree -->
        
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">Street Address</div>
                                    <div class="field-value"><%= user.application["education-last-school-street"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="education-last-school-street">
                                    <input class="input-box" type="text" name="education-last-school-street" id="education-last-school-street">
                                    <label class="show-edit-btn" for="education-last-school-street" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="education-last-school-street" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- education-last-school-street -->
        
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">City</div>
                                    <div class="field-value"><%= user.application["education-last-school-city"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="education-last-school-city">
                                    <input class="input-box" type="text" name="education-last-school-city" id="education-last-school-city">
                                    <label class="show-edit-btn" for="education-last-school-city" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="education-last-school-city" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- education-last-school-city -->
        
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">State/Province/Region</div>
                                    <div class="field-value"><%= user.application["education-last-school-state"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="education-last-school-state">
                                    <select autocomplete="off" class="input-box" name="education-last-school-state" id="education-last-school-state">
                                        <option value="DNU">do not update</option>
                                        <optgroup label="locations">
                                            <option value="Washington">Washington</option>
                                        </optgroup>
                                        <option value="Alaska">Alaska</option>
                                        <option value="Alabama">Alabama</option>
                                        <option value="Arkansas">Arkansas</option>
                                        <option value="Arizona">Arizona</option>
                                        <option value="California">California</option>
                                        <option value="Colorado">Colorado</option>
                                        <option value="Connecticut">Connecticut</option>
                                        <option value="Washington DC">Washington DC</option>
                                        <option value="Delaware">Delaware</option>
                                        <option value="Florida">Florida</option>
                                        <option value="Georgia">Georgia</option>
                                        <option value="Hawaii">Hawaii</option>
                                        <option value="Iowa">Iowa</option>
                                        <option value="Idaho">Idaho</option>
                                        <option value="Illinois">Illinois</option>
                                        <option value="Indiana">Indiana</option>
                                        <option value="Kansas">Kansas</option>
                                        <option value="Kentucky">Kentucky</option>
                                        <option value="Louisiana">Louisiana</option>
                                        <option value="Massachusetts">Massachusetts</option>
                                        <option value="Maryland">Maryland</option>
                                        <option value="Maine">Maine</option>
                                        <option value="Michigan">Michigan</option>
                                        <option value="Minnesota">Minnesota</option>
                                        <option value="Missouri">Missouri</option>
                                        <option value="Mississippi">Mississippi</option>
                                        <option value="Montana">Montana</option>
                                        <option value="North Carolina">North Carolina</option>
                                        <option value="North Dakota">North Dakota</option>
                                        <option value="Nebraska">Nebraska</option>
                                        <option value="New Hampshire">New Hampshire</option>
                                        <option value="New Jersey">New Jersey</option>
                                        <option value="New Mexico">New Mexico</option>
                                        <option value="Nevada">Nevada</option>
                                        <option value="New York">New York</option>
                                        <option value="Ohio">Ohio</option>
                                        <option value="Oklahoma">Oklahoma</option>
                                        <option value="Oregon">Oregon</option>
                                        <option value="Pennsylvania">Pennsylvania</option>
                                        <option value="Rhode Island">Rhode Island</option>
                                        <option value="South Carolina">South Carolina</option>
                                        <option value="South Dakota">South Dakota</option>
                                        <option value="Tennessee">Tennessee</option>
                                        <option value="Texas">Texas</option>
                                        <option value="Utah">Utah</option>
                                        <option value="Virginia">Virginia</option>
                                        <option value="Vermont">Vermont</option>
                                        <option value="Wisconsin">Wisconsin</option>
                                        <option value="West Virginia">West Virginia</option>
                                        <option value="Wyoming">Wyoming</option>
                                    </select>
                                    <label class="show-edit-btn" for="education-last-school-state" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="education-last-school-state" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- education-last-school-state -->
        
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">Postal/Zip Code</div>
                                    <div class="field-value"><%= user.application["education-last-school-zip"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="education-last-school-zip">
                                    <input class="input-box" type="number" min=0 name="education-last-school-zip" id="education-last-school-zip">
                                    <label class="show-edit-btn" for="education-last-school-zip" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="education-last-school-zip" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- education-last-school-zip -->
                        </details>


                        <!-- Military info -->
                        <details class="row-item" id="military-details">   <!-- id is used for open details after backlink -->
                            <summary>
                                <% if(user.application["military-branch"]) { %>
                                    MILITARY STATUS [not empty]
                                <% } else { %>
                                    MILITARY STATUS [empty]
                                <% } %>
                            </summary>
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">Branch of Service</div>
                                    <div class="field-value"><%= user.application["military-branch"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="military-branch">
                                    <input class="input-box" type="text" name="military-branch" id="military-branch">
                                    <label class="show-edit-btn" for="military-branch" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="military-branch" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- military-branch -->
        
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">FROM and TO</div>
                                    <div class="field-value"><%= user.application["military-from-to"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="military-from-to">
                                    <input class="input-box" type="text" name="military-from-to" id="military-from-to">
                                    <label class="show-edit-btn" for="military-branch" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="military-from-to" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- military-from-to -->
        
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">Rank at Discharge</div>
                                    <div class="field-value"><%= user.application["military-rank"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="military-rank">
                                    <input class="input-box" type="text" name="military-rank" id="military-rank">
                                    <label class="show-edit-btn" for="military-rank" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="military-rank" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- military-rank -->
        
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">Date of Discharge</div>
                                    <div class="field-value"><%= user.application["military-discharge-date"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="military-discharge-date">
                                    <input class="input-box" type="date" name="military-discharge-date" id="military-discharge-date">
                                    <label class="show-edit-btn" for="military-discharge-date" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="military-discharge-date" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- military-discharge-date -->
                        </details>


                        <!-- Accidents info -->
                        <details class="row-item" id="accident-details">   <!-- id is used for open details after backlink -->
                            <summary>ACCIDENT RECORDS [<%= user.application["accident-record1"] %>]</summary>
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">1. Date of Accident. State. Nature of Accident. Fault.</div>
                                    <div class="field-value -orange"><%= user.application["accident-record1"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="accident-record1">
                                    <input class="input-box" type="text" name="accident-record1" id="accident-record1">
                                    <label class="show-edit-btn" for="accident-record1" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="accident-record1" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- accident-record1 -->
        
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">2. Date of Accident. State. Nature of Accident. Fault.</div>
                                    <div class="field-value -orange"><%= user.application["accident-record2"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="accident-record2">
                                    <input class="input-box" type="text" name="accident-record2" id="accident-record2">
                                    <label class="show-edit-btn" for="accident-record2" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="accident-record2" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- accident-record2 -->
        
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">3. Date of Accident. State. Nature of Accident. Fault.</div>
                                    <div class="field-value -orange"><%= user.application["accident-record3"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="accident-record3">
                                    <input class="input-box" type="text" name="accident-record3" id="accident-record3">
                                    <label class="show-edit-btn" for="accident-record3" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="accident-record3" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- accident-record3 -->
                        </details>


                        <!-- TRAFFIC CONVICTIONS -->
                        <details class="row-item" id="traffic-details">   <!-- id is used for open details after backlink -->
                            <summary>TRAFFIC CONVICTIONS [<%= user.application["conviction-record1"] %>]</summary>
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">1. Date. State. Violation. Penalty.</div>
                                    <div class="field-value -orange"><%= user.application["conviction-record1"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="conviction-record1">
                                    <input class="input-box" type="text" name="conviction-record1" id="conviction-record1">
                                    <label class="show-edit-btn" for="conviction-record1" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="conviction-record1" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- conviction-record1 -->
        
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">2. Date. State. Violation. Penalty.</div>
                                    <div class="field-value -orange"><%= user.application["conviction-record2"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="conviction-record2">
                                    <input class="input-box" type="text" name="conviction-record2" id="conviction-record2">
                                    <label class="show-edit-btn" for="conviction-record2" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="conviction-record2" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- conviction-record2 -->
        
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">3. Date. State. Violation. Penalty.</div>
                                    <div class="field-value -orange"><%= user.application["conviction-record3"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="conviction-record3">
                                    <input class="input-box" type="text" name="conviction-record3" id="conviction-record3">
                                    <label class="show-edit-btn" for="conviction-record3" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="conviction-record3" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- conviction-record3 -->
                        </details>


                        <!-- CRIMINAL CONVICTIONS -->
                        <details class="row-item" id="criminal-details">   <!-- id is used for open details after backlink -->
                            <summary>CRIMINAL CONVICTIONS [<%= user.application["criminal-record1"] %>]</summary>
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">1. Date, County, Felony/Misdemeanor.</div>
                                    <div class="field-value -orange"><%= user.application["criminal-record1"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="criminal-record1">
                                    <input class="input-box" type="text" name="criminal-record1" id="criminal-record1">
                                    <label class="show-edit-btn" for="criminal-record1" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="criminal-record1" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- criminal-record1 -->
        
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">2. Date, County, Felony/Misdemeanor.</div>
                                    <div class="field-value -orange"><%= user.application["criminal-record2"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="criminal-record2">
                                    <input class="input-box" type="text" name="criminal-record2" id="criminal-record2">
                                    <label class="show-edit-btn" for="criminal-record2" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="criminal-record2" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- criminal-record2 -->
        
                            <section class="row-item">
                                <div class="fields-set">
                                    <div class="field-title">3. Date, County, Felony/Misdemeanor.</div>
                                    <div class="field-value -orange"><%= user.application["criminal-record3"] %></div>
                                </div>
                                <div class="edit-set -hidden" name="appl-edits" data-id="criminal-record3">
                                    <input class="input-box" type="text" name="criminal-record3" id="criminal-record3">
                                    <label class="show-edit-btn" for="criminal-record3" onclick="cleanField(this)">Clear</label>
                                </div>
                                <label class="show-edit-btn" for="criminal-record3" onclick="toggleEditField(this)">Edit</label>
                            </section>  <!-- criminal-record3 -->
                        </details>


                        <!-- Employers info -->
                        <div class="field-subheader-black">10 YEAR EMPLOYMENT HISTORY</div>

                        <div class="fields-set">
                            <div class="field-title">Can contact/Verify:</div>
                            <div class="field-value -orange"><%= user.application["employer-contact"] %></div>
                        </div>

                        <% if(user.application.employers.length) { %>
                            <% user.application.employers.forEach((employer, index) => { %>
                                <details class="row-item" id="company-details">   <!-- id is used for open details after backlink -->
                                    <summary>#<%= index + 1 %> <%= employer["employer-company"].toUpperCase() %></summary>
                                    <section class="row-item">
                                        <div class="fields-set">
                                            <div class="field-title">Company</div>
                                            <div class="field-value -italic"><%= employer["employer-company"] %></div>
                                        </div>
                                        <div class="edit-set -hidden" name="appl-edits" data-id="employer<%= index %>-company">
                                            <input class="input-box" type="text" name="employer<%= index %>-company" id="employer<%= index %>-company">
                                            <label class="show-edit-btn" for="employer<%= index %>-company" onclick="cleanField(this)">Clear</label>
                                        </div>
                                        <label class="show-edit-btn" for="employer<%= index %>-company" onclick="toggleEditField(this)">Edit</label>
                                    </section>  <!-- employer-company -->
            
                                    <section class="row-item">
                                        <div class="fields-set">
                                            <div class="field-title">Address,City,State,Zip</div>
                                            <div class="field-value"><%= employer["employer-address"] %></div>
                                        </div>
                                        <div class="edit-set -hidden" name="appl-edits" data-id="employer<%= index %>-address">
                                            <input class="input-box" type="text" name="employer<%= index %>-address" id="employer<%= index %>-address">
                                            <label class="show-edit-btn" for="employer<%= index %>-address" onclick="cleanField(this)">Clear</label>
                                        </div>
                                        <label class="show-edit-btn" for="employer<%= index %>-address" onclick="toggleEditField(this)">Edit</label>
                                    </section>  <!-- employer-address -->
            
                                    <section class="row-item">
                                        <div class="fields-set">
                                            <div class="field-title">Supervisor, Phone</div>
                                            <div class="field-value"><%= employer["employer-supervisor"] %></div>
                                        </div>
                                        <div class="edit-set -hidden" name="appl-edits" data-id="employer<%= index %>-supervisor">
                                            <input class="input-box" type="text" name="employer<%= index %>-supervisor" id="employer<%= index %>-supervisor">
                                            <label class="show-edit-btn" for="employer<%= index %>-supervisor" onclick="cleanField(this)">Clear</label>
                                        </div>
                                        <label class="show-edit-btn" for="employer<%= index %>-supervisor" onclick="toggleEditField(this)">Edit</label>
                                    </section>  <!-- employer-supervisor -->
            
                                    <section class="row-item">
                                        <div class="fields-set">
                                            <div class="field-title">Position Held, From To</div>
                                            <div class="field-value"><%= employer["employer-position"] %></div>
                                        </div>
                                        <div class="edit-set -hidden" name="appl-edits" data-id="employer<%= index %>-position">
                                            <input class="input-box" type="text" name="employer<%= index %>-position" id="employer<%= index %>-position">
                                            <label class="show-edit-btn" for="employer<%= index %>-position" onclick="cleanField(this)">Clear</label>
                                        </div>
                                        <label class="show-edit-btn" for="employer<%= index %>-position" onclick="toggleEditField(this)">Edit</label>
                                    </section>  <!-- employer-position -->
                                </details>
                            <% }) %>
                        <% } else { %>  <!-- noone entered, printing 1 blank for additing -->
                            <details class="row-item" id="company-details">   <!-- id is used for open details after backlink -->
                                <summary>No info, you can add</summary>
                                <section class="row-item">
                                    <div class="fields-set">
                                        <div class="field-title">Company</div>
                                        <div class="field-value">no info, you can add...</div>
                                    </div>
                                    <div class="edit-set -hidden" name="appl-edits" data-id="employer1-company">
                                        <input class="input-box" type="text" name="employer1-company" id="employer1-company">
                                        <label class="show-edit-btn" for="employer1-company" onclick="cleanField(this)">Clear</label>
                                    </div>
                                    <label class="show-edit-btn" for="employer1-company" onclick="toggleEditField(this)">Edit</label>
                                </section>  <!-- employer1-company -->
        
                                <section class="row-item">
                                    <div class="fields-set">
                                        <div class="field-title">Address,City,State,Zip</div>
                                        <div class="field-value">no info, you can add...</div>
                                    </div>
                                    <div class="edit-set -hidden" name="appl-edits" data-id="employer1-address">
                                        <label class="show-edit-btn" for="employer1-address" onclick="cleanField(this)">Clear</label>
                                        <input class="input-box" type="text" name="employer1-address" id="employer1-address">
                                    </div>
                                    <label class="show-edit-btn" for="employer1-address" onclick="toggleEditField(this)">Edit</label>
                                </section>  <!-- employer1-address -->
        
                                <section class="row-item">
                                    <div class="fields-set">
                                        <div class="field-title">Supervisor, Phone</div>
                                        <div class="field-value">no info, you can add...</div>
                                    </div>
                                    <div class="edit-set -hidden" name="appl-edits" data-id="employer1-supervisor">
                                        <input class="input-box" type="text" name="employer1-supervisor" id="employer1-supervisor">
                                        <label class="show-edit-btn" for="employer1-supervisor" onclick="cleanField(this)">Clear</label>
                                    </div>
                                    <label class="show-edit-btn" for="employer1-supervisor" onclick="toggleEditField(this)">Edit</label>
                                </section>  <!-- employer1-supervisor -->
        
                                <section class="row-item">
                                    <div class="fields-set">
                                        <div class="field-title">Position Held, From To</div>
                                        <div class="field-value">no info, you can add...</div>
                                    </div>
                                    <div class="edit-set -hidden" name="appl-edits" data-id="employer1-position">
                                        <input class="input-box" type="text" name="employer1-position" id="employer1-position">
                                        <label class="show-edit-btn" for="employer1-position" onclick="cleanField(this)">Clear</label>
                                    </div>
                                    <label class="show-edit-btn" for="employer1-position" onclick="toggleEditField(this)">Edit</label>
                                </section>  <!-- employer1-position -->
                            </details>
                        <% } %>

                    </div>     <!-- block-box-right -->

                    <!-- contains all updated MODELS fields -->
                    <input type="hidden" name="whatWasUpdated"  data-updated="appl-edits" />

                    <div class="block-box-left">
                        <!-- @SIGNATURE -->
                        <section class="row-item">
                            <div class="field-title">completed as of</div>
                            <div class="field-value -left-just"><%= new Date(user.application.created).toLocaleDateString("en-CA", { timeZone: locals.SCHOOL_DATA.tZONE }) %> (<%= new Date(user.application.created).toLocaleTimeString("en-US", { timeZone: locals.SCHOOL_DATA.tZONE, hour12: false }) %>)</div>
                        </section>

                        <!-- @ADMIN CHANGED -->
                        <% if(user.application.updatedAdmin) { %>
                            <% 
                                let updater = user.application.updatedAdmin + " "
                                updater += new Date(user.application.updatedDate).toLocaleDateString("en-CA", { timeZone: locals.SCHOOL_DATA.tZONE }) + " "
                                updater += "("+new Date(user.application.updatedDate).toLocaleTimeString("en-US", { timeZone: locals.SCHOOL_DATA.tZONE, hour12: false }) + ")"
                            %>
                            <section class="row-item">
                                <div class="field-title">updated by</div>
                                <div class="field-value"><%= updater %></div>
                            </section>
                        <% } %>
                    </div>      <!-- block-box-left -->
                    <div class="block-box-right">
                        <!-- @BUTTONS -->
                        <section class="row-buttons">
                            <a class="-btn" href="/admin/print-form/<%= user._id %>?form=form2">Print</a>
                            <button type="submit" class="-btn">Update</button>
                        </section>
                    </div>      <!-- block-box-right -->

                </form>   <!-- block2 -->
            <% } else { %>
                <div class="field-info">Application Form was not filled out yet</div>
                <% if(user.dataCollection) { %>
                    <div class="field-info1">Data Collection has been completed, so Application form is a next user's step.  Application is one of the biggest forms, it takes time to fill it out accurately, so be patient)) Actually,<span class="field-link"> as an ADMIN you can advice user how to make it right.</span> This approach will save your further work time when fixing mistakes will be needed.</div>
                <% } else { %>
                    <div class="field-warning">Data Collection hasn't been completed by user yet. They should stick with Data Collection first of all, since that form is a basic one.</div>
                <% } %>
            <% } %>
        </section>  <!-- block-box -->

        

        <!-- @AGREEMENT  id=block3 -->
        <section class="block-box -hidden" name="blockBox" id="block3">
            <%- include("userInfo_agreement.ejs") %>
        </section>  <!-- block-box -->


        <!-- @STUDENT  id=block4 -->
        <section class="block-box -hidden" name="blockBox" id="block4">
            <%- include("userInfo_student.ejs") %>
        </section>  <!-- block-box -->


        <!-- @GRADUATE  id=block5 -->
        <section class="block-box -hidden" name="blockBox" id="block5">
            <%- include("userInfo_graduate.ejs") %>
        </section>  <!-- block-box -->

    </div>  <!-- main-box -->

    
    
    
    <script defer>

        // password show/hide
        function toggleVisibility(toggler, password) {
            password.type = toggler.checked ? "text" : "password"
        }

        
        // @CURRENCY ENTERING routines
        // INPUTS - cost items
        const costItems = [
            document.querySelector("#tuitionCost"),
            document.querySelector("#regisrFee"),
            document.querySelector("#supplyFee"),
            document.querySelector("#otherFee")
        ]   

        function updateSpan(currencyInput) {
            // shows amount into span near
            const span = document.querySelector(`[name=${currencyInput.id}]`) // span has NAME equals input"s ID
            const text = currencyInput.value
            const num = Number.isNaN(parseFloat(text)) ? 0 : parseFloat(text)
            
            span.textContent = new Intl.NumberFormat("us-US", { style: "currency", currency: "USD" }).format(num)
            
            // adding/removing PARROT class to SPAN
            if (num) {
                span.classList.add("parrot")
            } else {
                span.classList.remove("parrot")
            }

            // calc. total
            const spanTotal = document.querySelector("[name=agrTotal]") // span has NAME equals input"s ID

            let sum = 0
            costItems.forEach(item => {
                sum += Number.isNaN(parseFloat(item.value)) ? 0 : parseFloat(item.value)
            })

            spanTotal.textContent = new Intl.NumberFormat("us-US", { style: "currency", currency: "USD" }).format(sum)
            // adding/removing PARROT class to TOTAL
            if (sum) {
                spanTotal.classList.add("parrot")
            } else {
                spanTotal.classList.remove("parrot")
            }

        }


        // SHOW edit field
        function toggleEditField(label) {
            const parentRow = label.parentElement
            const itemSet = parentRow.querySelectorAll(".fields-set")[0]
            const divHidden = document.querySelector(`[data-id="${label.htmlFor}"]`)
            const input = document.getElementById(label.htmlFor)
            
            if (!divHidden || !input || !itemSet) { return }
                
            itemSet.classList.toggle("-hidden")
            divHidden.classList.toggle("-hidden")

            if(divHidden.classList.contains("-hidden")) {
                label.textContent = "Edit"
                cleanField(label)
            } else {
                label.textContent = "Cancel"
            }
        }


        // compares two 1v arrays
        const equals = (a, b) =>
        a.length === b.length &&
        a.every((v, i) => v === b[i])


        // checks if any of inputs were updated
        
        async function checkAllGroupHiddenDivs(divsToCheck) {
            let changedFields = []

            for (let i=0; i<divsToCheck.length; i++) {
                
                let labelItem = divsToCheck[i].nextElementSibling
                let inputItem = document.getElementById(divsToCheck[i].dataset.id)

                if (labelItem && inputItem) {
                    // there is a difference when checking update status of INPUT and DIV with inputs
                    if (inputItem.hasChildNodes() && inputItem.tagName != "SELECT") {
                        
                        const childInputs = inputItem.getElementsByTagName("INPUT")     //  receiving all inputs
                        const inputItemDataValue = inputItem.dataset.value.split(",")    //  divs data-value should contain pmts: cast,check,third part etc.
                        let currentValues = []      //  empty array to compare with divs data-value
    
                        if (childInputs && inputItemDataValue) {
                            for (let i=0; i < childInputs.length; i++) {
                                if (childInputs[i].checked) { currentValues.push(childInputs[i].value) }
                            }
                            if (!equals(inputItemDataValue, currentValues)) {
                                changedFields.push(labelItem.htmlFor)     // add to updates fields only if not equal with it"s start value string
                            }
                        }
                    } else {
                        if (inputItem.value != "" && inputItem.value != "DNU") {
                            divsToCheck[i].classList.remove("-hidden")
                            changedFields.push(labelItem.htmlFor)
                        }
                    }
                }
                
            }
            return changedFields    // returning fields changed
        }
        

        // learning input field
        function cleanField(label) {
            const input = document.getElementById(label.htmlFor)
            if (input) {
                if (input.tagName === "INPUT") { input.value = "" }
                if (input.tagName === "SELECT") { input.value = "DNU" }
                
                if (input.tagName === "DIV") { 
                    // DIV has to include other inputs
                    const childInputs = input.getElementsByTagName("INPUT")
                    if (childInputs) {
                        for (let i=0; i < childInputs.length; i++) {
                            childInputs[i].checked = false
                        }
                    }
                }
            }
        }

        function redoField(paymentsDiv, paymentsString) {
            const payments = paymentsString.split(",")      //  parsing given paymentsString
            const childInputs = paymentsDiv.getElementsByTagName("INPUT")     //  receiving all child inputs
            if (childInputs) {
                for (let i=0; i < childInputs.length; i++) {
                    childInputs[i].checked = payments.includes(childInputs[i].value)
                }
            }
        }


        // Listeners for all forms when updating
        async function checkUpdates(name) {
            // general middleware before updating
            const changed = await checkAllGroupHiddenDivs(document.querySelectorAll(`[name="${name}"]`))

            if (changed.length === 0) {
                alert("There is nothing to change. You didn't update any field")
                return false
            }
            if(!confirm(`This will update current record with fields(${changed.length}):\n+ ${changed.join(",\n+ ").toUpperCase()}.\nAre you sure?`)) {
                return false
            }
            
            // updating INPUT name="whatWasUpdated" before getting back to server
            document.querySelector(`[data-updated=${name}]`).value = changed.toString()

            return true
        }


        function initializeFormWithUpdateListener(formId, inputGroup) {
            const form = document.getElementById(formId)
            if (form && form != null) {
                form.addEventListener("submit", async (e) => {
                    const anyChanges = await checkUpdates(inputGroup)
                    if (!anyChanges) { e.preventDefault() }
                })
            }
        }

        // @ENTRY POINT
        // Init all forms and setup update listeners for each

        initializeFormWithUpdateListener("form1", "data-coll-edits")
        initializeFormWithUpdateListener("form2", "appl-edits")
        initializeFormWithUpdateListener("form3", "agr-edits")

      

        // @MIAN Block's toggler
        function toggleBlock(navItem) {
            const targetBlock = document.getElementById(navItem.getAttribute("name"))
            if (targetBlock) {    // if block exists
                // hiding all blocks
                document.getElementsByName("blockBox").forEach(block => {
                    block.classList.add("-hidden")
                    block.dataset.active = "no"
                })
                // showing target one
                targetBlock.classList.remove("-hidden")
                targetBlock.dataset.active = "active"

                // activating active menu item
                Array.from(document.getElementsByClassName("block-title")).forEach(blockTitle => {
                    blockTitle.classList.remove("-nav-item-active")
                })
                // showing target one
                navItem.classList.add("-nav-item-active")
            }
        }   // toggleBlock



        function getActiveBlock() {
            let result = 0
            // going though all blocks
            document.getElementsByName("blockBox").forEach((block, index) => {
                if (block.dataset.active === "active") {
                    result = index + 1
                }
            })
            return result
        }


        // "tab", if set, choose what tab to show
        switch ("<%= tab %>") {
            case "5":
                document.querySelector("[name=block5]").click()
            break;
            case "4":
                document.querySelector("[name=block4]").click()
            break;
            case "3":
                document.querySelector("[name=block3]").click()
            break;
            case "2":
                document.querySelector("[name=block2]").click()
            break;
            default:
                document.querySelector("[name=block1]").click()     // showing block #1 as default
            break;
        }

        // "open", if set, choose details group to open
        function openIfExists(detailsId) {
            let details = document.querySelector(detailsId)
            if(details) {
                details.open = true
                details.scrollIntoView({block: "end", behavior: "smooth"})
            }
        }

        switch ("<%= open %>") {
            case "tuition":
                openIfExists("#tuition-details")
            break;
            case "clocks":
                openIfExists("#clocks-details")
            break;
            case "scorings":
                openIfExists("#scoring-details")
            break;
            case "schedule":
                openIfExists("#schedule-details")
            break;
            case "payments":
                openIfExists("#payments-details")
            break;
            case "fmcsaSteps":
                openIfExists("#steps-details")
            break;
            // details can be added here
        }


        // MENU Actions
        async function updateUser(action) {
            return await fetch("/admin/user", {
                method: "PUT",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    studentId: "<%= user.student ? user.student._id : undefined %>",
                    userId: "<%= user._id %>",
                    action
                })
            })
        }

        // Action on Menu items click
        async function menuAction(action) {
            // Confirmations
            if (action === "delete" && !confirm("Do you want to delete this Student without a possibility to recover?")) {
                return
            }
            if (action === "block" && !confirm("Would you like to BLOCK this student?")) {
                return
            }
            // ACTION section
            const result = await updateUser(action)     //  doing PUT for all actions
            // getting back with response
            if (!result) { return alert(`Action "${action.toUpperCase()}" was not done`) }
            if (result.status != 200) {
                const res = await result.json()
                return alert(`Error: ${res.issue}`)
            }
            // status 200, everything is OK
            if (action === "delete") {
                document.getElementById("user-area").click()
            }   // DELETE
            else {
                const back = document.getElementById("for-getting-back")
                const activeBlock = getActiveBlock()
                if (back && activeBlock) {
                    back.setAttribute("href", `/admin/user/${back.dataset.user}?activatetab=${activeBlock}`)
                    back.click()
                }
                alert("Done successfully")
            }
        }


    </script>


</body>
</html>